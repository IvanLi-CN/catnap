# UI 设计（#0009）

本目录补齐本计划涉及的 UI 变更与交互口径，并解释“为何这样放/如何表现状态”，避免实现阶段边做边改。

本计划的设计图（以这些 SVG 为准）：

- `./products.svg`
- `./inventory-monitor.svg`
- `./settings.svg`

实现阶段要求：当本计划进入实现并完成 UI 改动后，需要把上述 SVG **同步替换**到项目级集合 `docs/ui/`（并更新 `docs/ui/README.md` 的来源映射），保证工程内“最新设计图”不依赖 plan 目录。

本计划更新的页面：

- 全部产品（按钮“立即刷新”=全量刷新；下架标记）
- 库存监控（最近 24 小时上架区域；同一套刷新状态）
- 系统设置（自动全量刷新间隔；上架/下架监控开关）

## 顶部动作区（全局）

### 顶部动作区布局（基于现有 UI）

- 顶栏右侧（按页面差异化，与现有 UI 保持一致）：
  - “全部产品”：主动作按钮（`立即刷新`）+ `主题 …`
  - “库存监控”：`最近刷新：…` + 现有主动作按钮（`重新同步`）+ `主题 …`

### 主要动作：立即刷新（全量）

- 位置：顶栏右侧主动作按钮。
- 文案：
  - idle：`立即刷新`
  - running：`立即刷新（done/total）`（或等价展示：按钮内显示 `刷新中（done/total）`）
  - success：短暂展示 `刷新完成` 后回到 idle（实现细节可按现有同步按钮口径复用）
  - error：展示 `刷新失败`（可点击关闭错误提示，按钮回到 idle）
- 视觉状态：
  - running：按钮禁用 + 旋转图标（或等价“忙碌”态）；所有页面共享同一状态（来自 SSE）。
  - success/error：按钮图标与色相变化（与现有 “重新同步” 的 ok/err 口径一致）。
- Tooltip（可选）：`强制全量刷新（30s 限流）`。

### 刷新来源提示（可选）

当 `trigger=auto` 时，running 状态旁可显示一个弱提示：`自动`（避免用户误以为是误触）。

## “全部产品”页（products）

### 立即刷新按钮

- 顶栏右侧按钮从 `刷新：手动` 改为 `立即刷新`，并且触发全量刷新。
- 运行中展示 `刷新中（done/total）`；该状态来自 SSE，非本地推断。

### 下架标记

- 下架配置在卡片右上角显示 `下架` badge（未下架不显示）。
- 下架配置的库存展示为 `库存 —`（或等价不可用态），监控开关展示为 `监控：禁用`（避免对已下架配置继续开关造成困惑）。

## “库存监控”页（inventory-monitor）

### 最近 24 小时上架

- 顶部新增一块 `最近 24 小时上架`：
  - 口径：`listed`（含 `relisted`）。
  - 展示：按时间倒序；使用与监控页其它区域一致的配置卡片尺寸（信息更完整）。
    - 每项至少包含：配置名、国家/可用区、规格要点、价格、发生时间（相对时间即可）。
  - 无数据时：不展示该区块（避免空态文案占位）。

### 立即刷新按钮

- “监控”页现有的 `重新同步` 按钮也使用同一 SSE 状态（包括系统自动刷新期间的 running/success/error），避免出现“产品页在刷新但监控页无感”的割裂。

## “系统设置”页（settings）

### 全量刷新（Catalog refresh）

- 新增区块：
  - `自动全量刷新间隔（小时）`：数字输入；`null`/关闭表示禁用自动刷新。
  - 不在界面展示“全局取最小值”的规则；仅提供间隔输入与“关闭=禁用”的直觉语义。

### 上架/下架监控

- 在通知相关区域增加两个开关：
  - `上架监控`
  - `下架监控`
- 说明：启用后在事件发生时，会向“所有启用该开关的用户”发送通知（具体渠道由 Telegram/Web Push 的启用状态决定）。该说明不需要写在 UI 上。

### Telegram / Web Push

- 本计划的设置页设计图需完整展示 Telegram 与 Web Push 的配置字段与主要操作（不再省略）：
  - Telegram：启用开关、Bot Token（不回显）、Target
  - Web Push：启用开关、必要前置提示（HTTPS/localhost）、“启用推送”按钮
  - 页面底部提供“保存设置”按钮
- 设置页允许正常增加设计图高度以保持 8pt grid 的间距节奏；不强行把内容挤在单屏内。
